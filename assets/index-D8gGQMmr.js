import{j as e,G as t,T as p,B as x,L as i,d as k,c as R,r as c,I as j,a as y,b as V,D as Y,u as I}from"./index-C9bWR1SX.js";import{I as D,D as v,C as $,M as A,c as F,u as z,L as W,a as q,s as b,n as G,P as U,b as X,d as H,S as O}from"./ContextPopup-C9i8nDyv.js";import{u as _,P as h,A as E,a as S,M as J,S as K,b as C}from"./Switch-FuFYDnQc.js";import{C as g}from"./Collapser-s6hQ8r5M.js";k.extend(R);const Q=({controls:s})=>{const l=i.addTask,{control:n,formState:{isValid:a},handleSubmit:o,reset:d}=_({mode:"onChange",defaultValues:{name:"",desc:""}}),u=m=>{l(m),d(),s.close()};return e.jsx(h,{controls:s,minWidth:300,children:e.jsxs(t,{column:!0,children:[e.jsx(p,{children:"Добавить задачу"}),e.jsxs("form",{onSubmit:o(u),children:[e.jsx(h.Scroller,{children:e.jsxs(t,{column:!0,children:[e.jsx(D,{label:"Название",placeholder:"Сделать...",name:"name",rules:{required:"Обязательное"},control:n,autoFocus:!0}),e.jsx(E,{label:"Описание",placeholder:"И не забыть...",name:"desc",control:n}),e.jsx(v,{label:"Начало",name:"start",control:n}),e.jsx(v,{label:"Конец",name:"end",control:n})]})}),e.jsxs(S,{children:[e.jsx(x,{type:"submit",visualDisabled:!a,children:"Добавить"}),e.jsx(x,{onClick:s.close,children:"Отмена"})]})]})]})})},Z=s=>({asc:l=>l.sort((n,a)=>n[s]===a[s]?0:n[s]?-1:1),desc:l=>l.sort((n,a)=>n[s]===a[s]?0:n[s]?1:-1)}),ee=s=>c.createElement("svg",{id:"\\u0421\\u043B\\u043E\\u0439_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 24 24",style:{enableBackground:"new 0 0 24 24"},xmlSpace:"preserve",fill:"currentColor",stroke:"transparent",...s},c.createElement("path",{d:"M8,20L8,20c-1.1,0-2-0.9-2-2V7c0-1.1,0.9-2,2-2h0c1.1,0,2,0.9,2,2v11C10,19.1,9.1,20,8,20z"}),c.createElement("path",{d:"M16,20L16,20c-1.1,0-2-0.9-2-2V7c0-1.1,0.9-2,2-2h0c1.1,0,2,0.9,2,2v11C18,19.1,17.1,20,16,20z"})),se=c.memo(ee),ne=s=>c.createElement("svg",{id:"\\u0421\\u043B\\u043E\\u0439_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 24 24",style:{enableBackground:"new 0 0 24 24"},xmlSpace:"preserve",fill:"currentColor",stroke:"transparent",...s},c.createElement("path",{d:"M6,18V6c0-1.3,1.4-2.2,2.6-1.5l10.6,6c1.2,0.7,1.2,2.4,0,3l-10.6,6C7.4,20.2,6,19.3,6,18z"})),ae=c.memo(ne),le=({handleModifyTask:s,handleRemoveTask:l,controls:n})=>{const a=(o=()=>{})=>()=>{n.close(),o()};return e.jsx($,{controls:n,children:e.jsxs(t,{column:!0,children:[e.jsx(j,{icon:A,label:"Изменить",onClick:a(s)}),e.jsx(j,{icon:J,label:"Удалить",onClick:a(l)})]})})};k.extend(R);const oe=({id:s,controls:l})=>{const n=i.getTask(s),a=i.modifyTask,{control:o,formState:{isValid:d},handleSubmit:u}=_({mode:"onChange",defaultValues:{name:n.name,desc:n.desc,start:k(n.start,"DD.MM.YYYY"),end:k(n.end,"DD.MM.YYYY")}}),m=f=>{a(s,f),l.close()};return e.jsx(h,{controls:l,minWidth:300,children:e.jsxs(t,{column:!0,children:[e.jsx(p,{children:"Изменить задачу"}),e.jsxs("form",{onSubmit:u(m),children:[e.jsx(h.Scroller,{children:e.jsxs(t,{column:!0,children:[e.jsx(D,{label:"Название",placeholder:"Сделать...",name:"name",rules:{required:"Обязательное"},control:o,autoFocus:!0}),e.jsx(E,{label:"Описание",placeholder:"И не забыть...",name:"desc",control:o}),e.jsx(v,{label:"Начало",name:"start",control:o}),e.jsx(v,{label:"Конец",name:"end",control:o})]})}),e.jsxs(S,{children:[e.jsx(x,{type:"submit",visualDisabled:!d,children:"Сохранить"}),e.jsx(x,{onClick:l.close,children:"Отмена"})]})]})]})})},te=({id:s,controls:l})=>{const n=i.getTask(s),a=i.removeTask,o=i.disableTaskRemoveConfirmation,{control:d,getValues:u}=_(),m=()=>{u("disableTaskRemoveConfirmation")&&o(),a(s),l.close()};return e.jsx(h,{controls:l,maxWidth:340,children:e.jsxs(t,{column:!0,children:[e.jsx(p,{children:"Удаление задачи"}),e.jsxs("p",{children:['Вы действительно хотите удалить задачу "',n.name,'"?']}),e.jsx(K,{label:"Не спрашивать снова",name:"disableTaskRemoveConfirmation",control:d,autoFocus:!0}),e.jsxs(S,{children:[e.jsx(x,{onClick:m,children:"Удалить"}),e.jsx(x,{onClick:l.close,children:"Отмена"})]})]})})},ce="_Task_1ejdu_1",re="_done_1ejdu_6",de="_header_1ejdu_10",ie="_desc_1ejdu_10",ue="_actions_1ejdu_24",me="_button_1ejdu_28",xe="_inner_1ejdu_32",je="_p_1ejdu_36",r={Task:ce,done:re,header:de,desc:ie,actions:ue,button:me,inner:xe,p:je},he=c.memo(({task:{id:s,name:l,desc:n,start:a,end:o,done:d}})=>{const u=i.toggleTask,m=i.removeTask,f=y(N=>N.taskRemoveConfirmation),T=c.useRef(null),B=c.useCallback(()=>F(T.current),[T]),w=z(B),M=C(),P=C(),L=()=>{f?P.open():m(s)};return e.jsxs(W,{className:V(r.Task,!d&&r.done),children:[e.jsxs(t,{column:!0,children:[e.jsxs(t,{className:r.header,children:[e.jsx(p,{children:l}),e.jsxs(t,{className:r.actions,children:[e.jsx(j,{className:r.button,cs:{inner:r.inner},icon:d?ae:se,onClick:()=>u(s)}),e.jsx(j,{className:r.button,cs:{inner:r.inner},ref:T,icon:q,onClick:w.open})]})]}),(n!==""||a||o)&&e.jsxs(t,{className:r.desc,children:[e.jsx("pre",{children:n}),(a||o)&&e.jsxs(t,{children:[e.jsxs(t,{column:!0,children:[a&&e.jsx("p",{className:r.p,children:"Начало: "}),o&&e.jsx("p",{className:r.p,children:"Завершение: "})]}),e.jsxs(t,{column:!0,children:[a&&e.jsx("p",{children:a}),o&&e.jsx("p",{children:o})]})]})]})]}),e.jsx(le,{handleModifyTask:M.open,handleRemoveTask:L,controls:w}),e.jsx(oe,{id:s,controls:M}),e.jsx(te,{id:s,controls:P})]})}),pe={id:G("id"),name:b("name"),desc:b("desc"),start:b("start"),end:b("end"),done:Z("done")},be=c.memo(({sort:s})=>{const l=y(a=>a.tasks),n=c.useMemo(()=>pe[(s==null?void 0:s.field)??"id"][(s==null?void 0:s.order)??"desc"](l),[l,s]);return e.jsxs(Y,{timeout:500,children:[l.length===0&&e.jsx(g,{children:e.jsx(p,{center:!0,indent:!0,children:"Задач не найдено"})}),n.map(a=>e.jsx(g,{children:e.jsx(he,{task:a})},a.id))]})}),ke=[{value:"id",label:"По умолчанию"},{value:"name",label:"По названию"},{value:"desc",label:"По описанию"},{value:"start",label:"По дате начала"},{value:"end",label:"По дате завершения"},{value:"done",label:"По выполнению"}],ve={id:[{value:"desc",label:"Сначала последние"},{value:"asc",label:"Сначала первые"}],name:[{value:"asc",label:"В алфавитном порядке"},{value:"desc",label:"В обратном порядке"}],desc:[{value:"asc",label:"В алфавитном порядке"},{value:"desc",label:"В обратном порядке"}],start:[{value:"asc",label:"Сначала недавние"},{value:"desc",label:"Сначала давние"}],end:[{value:"asc",label:"Сначала срочные"},{value:"desc",label:"Сначала несрочные"}],done:[{value:"desc",label:"Сначала не выполненные"},{value:"asc",label:"Сначала выполненные"}]},_e=()=>{const s=I(d=>d.setCurrentPageTitle);c.useLayoutEffect(()=>s("Задачи"));const l=C(),n=C(),[a,o]=c.useState(null);return e.jsxs(g,{children:[e.jsx(be,{sort:a}),e.jsx(U,{children:e.jsxs(t,{children:[e.jsx(j,{icon:X,onClick:()=>l.open()}),e.jsx(j,{icon:H,onClick:()=>n.open()})]})}),e.jsx(Q,{controls:l}),e.jsx(O,{controls:n,setSort:o,fields:ke,orders:ve})]})};export{_e as Tasks};
